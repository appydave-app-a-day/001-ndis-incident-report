const phase = $json.phase || "Unknown Phase";
const answers = Array.isArray($json.answers) ? $json.answers : [];

const narrativeFacts = answers.map((item, index) => {
  const question = item.question || `[Missing Question ${index+1}]`;
  const answer = item.answer || `[Missing Answer ${index+1}]`;
  return `- Q: ${question}\n  A: ${answer}`;
});

const prompt = `
You are a report-writing assistant.

Write a short, professional, and human-like narrative summarizing the following details from the "${phase}" phase of an incident.

Use the questions to understand context, but do not include them in your final response. Focus only on the information provided.

Details:
${narrativeFacts.join('\n')}

Respond in 2â€“3 sentences, like you're writing an incident report.
`.trim();

return [{ json: { prompt } }];


